# Tensorflow data pipeline
building an data pipeline using tensorflow tf.data to classify images of cats and dogs. 

In this project, we implement a data pipeline using tf.data to build a pipeline for dogs vs cats images. We used tensorflow 1.14.

After reading the image file paths and their labels, we build the dataset. This process is done by using tf.data.Dataset which loads, process and shuffles data into mini-batches. Processing an image includes reading and decoding the image , resizing it and normalizing its values. Note that in tensorflow we have to first define a graph, therefore, all these operations are done on tensors when building the graph. Therefore we have to use tensorflow library functions such as tf.image.decode_image, and tf.image.set_shape to work with tensors. We cannot use the libraries such as Pillow or OpenCV at this stage, because at the time of building a tensorflow graph we work with placeholders, variables and operations and not the real data( here images). 

In order to loop through the data generated by tf.data we use an iterator. For the train data, we use an initializable iterator, because we pass through the train data multiple times (during different epochs). Each time the get_next() method of the iterator is called, a batch is returned. 

It is important to note that the real data (images) is returned at the time we run the following line:

          x_batch, y_batch  = self.sess.run(self.dataset)

after this line we can use the pillow or openCV libraries and work with real images.


After building the input pipeline, we have to build the model. Here we use two placeholders: one for the images and one for their labels. Note that the first dimension of the placeholders is None. For example:

          self.x = tf.placeholder(tf.float32, [None, self.image_size[0],self.image_size[1],3], name='x')

This shows that the placeholder x is of shape (None, image_size[0], image_size[1], 3). Later, during execution the “None” is replaced by the number of images in each batch.

The values of these placeholders are specified during tensorflow session run by feeding in values using a feed dictionary:

      fd = {self.x: x_batch, self.y: y_batch, self.learning_rt: self.learning_rate}
      opt,acc  = self.sess.run([self.optim,self.accuracy], feed_dict=fd)
